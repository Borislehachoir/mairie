<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Test Articles</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

    <h1>Mes Articles</h1>
    
    <input type="text" id="ArticleInput" placeholder="Écris un truc...">
    <button onclick="envoyerArticle()">Envoyer</button>

    <ul id="listeArticles"></ul>

    <script>
        // 1. CONFIGURATION
         const supabaseUrl = 'https://xduuevajjufhvvhkipcy.supabase.co'
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhkdXVldmFqanVmaHZ2aGtpcGN5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ2OTU1NTEsImV4cCI6MjA4MDI3MTU1MX0.80TpFnuxPzM9q9XpKHnp_Pp7OBmCZlFx-LyLPf3bilE'
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey)

        // 2. FONCTION POUR LIRE LES MESSAGES
        async function chargerArticles() {
            
            let { data: articles, error } = await supabase
                .from('articles')
                .select('*')

            if (error) console.log("Erreur:", error)
            else {
                // On vide la liste et on la remplit
                const liste = document.getElementById('listeArticles')
                liste.innerHTML = "" 
                articles.forEach(msg => {
                  // Si ta colonne s'appelle 'content', sinon utilise le vrai nom de ta colonne (ex: 'texte')
                liste.innerHTML += `<li>${msg.description}</li>` 
            })
            }
        }

        // 3. FONCTION POUR AJOUTER UN MESSAGE
        async function envoyerArticle() {
            const texte = document.getElementById('ArticleInput').value
            
            // On insère dans la base
            const { error } = await supabase
                .from('articles')
                .insert({ content: texte }) // Assure-toi d'avoir une colonne 'content'

            if (error) alert("Erreur d'envoi")
            else {
                document.getElementById('ArticleInput').value = "" // On vide le champ
                chargerArticles() // On recharge la liste
            }
        }

        // On charge les messages au démarrage de la page
        chargerArticles()
    </script>
</body>
</html>
