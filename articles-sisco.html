<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Test Messages</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

    <h1>Mes Messages</h1>
    
    <input type="text" id="messageInput" placeholder="Écris un truc...">
    <button onclick="envoyerMessage()">Envoyer</button>

    <ul id="listeMessages"></ul>

    <script>
        // 1. CONFIGURATION
         const supabaseUrl = 'https://xduuevajjufhvvhkipcy.supabase.co' // Celle de ton image
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhkdXVldmFqanVmaHZ2aGtpcGN5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ2OTU1NTEsImV4cCI6MjA4MDI3MTU1MX0.80TpFnuxPzM9q9XpKHnp_Pp7OBmCZlFx-LyLPf3bilE' // Celle du menu API Keysgit add 
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey)

        // 2. FONCTION POUR LIRE LES MESSAGES
        async function chargerMessages() {
            // On demande tout le contenu de la table 'messages'
            let { data: messages, error } = await supabase
                .from('articles')
                .select('*')

            if (error) console.log("Erreur:", error)
            else {
                // On vide la liste et on la remplit
                const liste = document.getElementById('listeMessages')
                liste.innerHTML = "" 
                messages.forEach(msg => {
                    liste.innerHTML += `<li>${msg.content}</li>`
                })
            }
        }

        // 3. FONCTION POUR AJOUTER UN MESSAGE
        async function envoyerMessage() {
            const texte = document.getElementById('messageInput').value
            
            // On insère dans la base
            const { error } = await supabase
                .from('articles')
                .insert({ content: texte }) // Assure-toi d'avoir une colonne 'content'

            if (error) alert("Erreur d'envoi")
            else {
                document.getElementById('messageInput').value = "" // On vide le champ
                chargerMessages() // On recharge la liste
            }
        }

        // On charge les messages au démarrage de la page
        chargerMessages()
    </script>
</body>
</html>
